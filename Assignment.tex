\documentclass[12pt, a4paper]{article}
\usepackage{fontspec}
\usepackage{geometry}
\usepackage{apacite}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{afterpage}
\usepackage{lipsum}
\usepackage{ragged2e}
\usepackage{titletoc}       % 目录格式宏
\usepackage{multirow}
\usepackage{bookmark} % Fix issues with hyperref
\usepackage{amsmath} % Advanced math support
\usepackage{amssymb} % More math symbols
\usepackage{mathtools} % Additional math tools
\usepackage{graphicx} % Image handling
\usepackage{enumitem} % Enhanced list environments
\usepackage{tikz} % Drawing package
\usepackage{algorithm} % Algorithm package
\usepackage{algpseudocode} % Algorithmic pseudocode
\usepackage{listings} % Code listings
\usepackage{xcolor} % Color support
\usepackage{cite} % Enhanced citations
\usepackage{float} % Support for [H] option in figures
\usepackage{hyperref} % Hyperlinks
\usepackage{fancyhdr}

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    urlcolor=black,
    citecolor=black,
    filecolor=black,
    pdfborder={0 0 0}
}

% Define C language code style
\lstdefinestyle{CStyle}{
  language=C,
  basicstyle=\ttfamily\footnotesize,
  keywordstyle=\color{blue},
  stringstyle=\color{red},
  commentstyle=\color{green!70!black},
  morecomment=[l][\color{magenta}]{\#},
  numbers=left,
  numberstyle=\tiny\color{gray},
  stepnumber=1,
  numbersep=10pt,
  tabsize=4,
  showspaces=false,
  showstringspaces=false
}

% 定制section部分的格式
\titlecontents{section}[2em]
{\bfseries}% 设置部分标题为粗体
{\uppercase\thecontentslabel.}
{}
{\titlerule*[0.5pc]{}\bfseries\thecontentspage}% 设置页码为粗体和较大的字体

% 定制subsection部分的格式
\titlecontents{subsection}
[2em]
{\small}% 设置部分标题为较小的字体
{\thecontentslabel. }
{}
{\titlerule*[0.5pc]{}\bfseries\thecontentspage}

\newfontfamily\titlefont{Arial}[Scale=1.2] % 首页字号为小二/18pt 已设置好
\newfontfamily\theistitle{Times New Roman}[Scale=1.3]
\newfontfamily\fypsentence{Times New Roman}[Scale=1.1]
\renewcommand{\contentsname}{Table of Contents}

\renewcommand{\baselinestretch}{1.3} % 设置行间距为 1.3倍
\geometry{
	top=2.5cm,
	bottom=2.5cm,
	left=4cm,
	right=2.5cm
}


\pagestyle{fancy}
\fancyhf{}
\fancyhead[C]{XIAMEN UNIVERSITY MALAYSIA}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0pt} 
\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}